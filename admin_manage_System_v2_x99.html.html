<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RO 工會管理系統 - 會長專用</title>
    <style>
        /* --- 全域與 RO 風格 --- */
        body {
            font-family: "Microsoft JhengHei", sans-serif;
            background-color: #1a1a1a;
            background-image: radial-gradient(circle, #2c3e50, #000000);
            color: #e0e0e0;
            margin: 20px;
        }
        .ro-panel {
            background: rgba(30, 30, 30, 0.95);
            border: 2px solid #cfaa70;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 15px rgba(207, 170, 112, 0.3);
            max-width: 1200px;
            margin: 0 auto;
            min-height: 700px;
        }
        h2 {
            color: #ffde9e;
            text-align: center;
            border-bottom: 1px solid #cfaa70;
            padding-bottom: 10px;
            margin-top: 0;
        }

        /* --- 分頁籤設計 --- */
        .tab-container { 
            display: flex; 
            margin-bottom: 20px; 
            border-bottom: 2px solid #555; 
            overflow-x: auto; /* 避免分頁太多爆版 */
        }
        .tab-btn {
            padding: 10px 20px; background: #2a2a2a; border: 1px solid #555; border-bottom: none;
            color: #aaa; cursor: pointer; font-weight: bold; border-radius: 5px 5px 0 0; margin-right: 5px; white-space: nowrap;
        }
        .tab-btn:hover { background: #333; color: #fff; }
        .tab-btn.active { background: #4a90e2; color: #fff; border-color: #8abeff; }
        .tab-btn-add { background: #2ecc71; color: #fff; border-color: #27ae60; }
        .tab-btn-add:hover { background: #27ae60; }

        /* --- 內容區塊 --- */
        .tab-content { display: none; animation: fadeIn 0.3s; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* --- 輸入區與按鈕 --- */
        .input-group {
            display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;
            margin-bottom: 20px; padding: 15px; background: rgba(0, 0, 0, 0.3); border-radius: 8px;
        }
        .input-item { display: flex; flex-direction: column; }
        label { font-size: 0.8em; color: #aaa; margin-bottom: 5px; }
        input[type="text"], select {
            padding: 8px; background: #2a2a2a; border: 1px solid #555; color: #fff; border-radius: 4px; outline: none;
        }
        select { cursor: pointer; border-color: #cfaa70; }
        
        .ro-btn {
            padding: 8px 20px; background: linear-gradient(180deg, #4a90e2, #0056b3);
            color: white; border: 1px solid #8abeff; border-radius: 4px; cursor: pointer; font-weight: bold; align-self: flex-end;
        }
        .ro-btn:hover { filter: brightness(1.1); }
        .btn-delete { background: linear-gradient(180deg, #c0392b, #8e2a20); border-color: #e74c3c; }
        .btn-add-team { background: linear-gradient(180deg, #2ecc71, #27ae60); border-color: #2ecc71; margin-bottom: 10px;}

        /* --- 職業快篩區 --- */
        .filter-bar {
            display: flex; gap: 8px; flex-wrap: wrap; justify-content: center;
            margin-bottom: 15px; padding: 10px; border-bottom: 1px solid #444;
        }
        .filter-btn {
            padding: 5px 12px; border: 1px solid #555; background: #222; 
            color: #888; border-radius: 15px; cursor: pointer; font-size: 0.9em; transition: 0.2s;
        }
        .filter-btn:hover { border-color: #cfaa70; color: #fff; }
        .filter-btn.active { background: #cfaa70; color: #000; font-weight: bold; border-color: #fff; }

        /* --- 表格樣式 --- */
        table { width: 100%; border-collapse: separate; border-spacing: 0; margin-top: 10px; color: #ddd; }
        th {
            background: linear-gradient(180deg, #3d3d3d, #222); color: #ffde9e; padding: 12px; cursor: pointer;
            border-bottom: 2px solid #cfaa70; text-align: left;
        }
        td { padding: 12px; border-bottom: 1px solid #444; background: rgba(0, 0, 0, 0.2); }
        .editable { cursor: text; }
        .editable:focus { background: #000; border: 1px solid #cfaa70; outline: none; }
        .force-yes { color: #ff6b6b; font-weight: bold; cursor: pointer; }
        .force-no { color: #888; cursor: pointer; }
        .center-col { text-align: center; }
        .job-text { font-weight: bold; text-shadow: 1px 1px 2px #000; }

        /* --- 活動分組介面樣式 --- */
        .activity-container { display: flex; gap: 20px; height: 600px; }
        .standby-panel {
            flex: 1; background: rgba(0, 0, 0, 0.3); border: 1px solid #555; border-radius: 8px; padding: 10px; overflow-y: auto;
        }
        .standby-title {
            color: #ffde9e; text-align: center; margin-bottom: 10px; font-weight: bold; border-bottom: 1px solid #444; padding-bottom: 5px;
        }
        .member-card {
            display: flex; justify-content: space-between; align-items: center;
            background: #2a2a2a; border: 1px solid #444; margin-bottom: 5px; padding: 8px; border-radius: 4px;
        }
        .member-card.disabled { opacity: 0.5; pointer-events: none; background: #111; border-color: #222; }
        .member-card.disabled .job-text { color: #555 !important; }
        .member-info { display: flex; gap: 10px; align-items: center; }
        
        .squads-panel {
            flex: 3; display: flex; gap: 15px; overflow-x: auto; padding-bottom: 10px; align-items: flex-start;
        }
        .squad-box {
            min-width: 250px; background: rgba(40, 40, 40, 0.9); border: 1px solid #cfaa70; border-radius: 8px; padding: 10px; display: flex; flex-direction: column;
        }
        .squad-header { display: flex; justify-content: space-between; margin-bottom: 10px; border-bottom: 1px solid #555; padding-bottom: 5px; }
        .squad-name-input { background: transparent; border: none; color: #ffde9e; font-weight: bold; font-size: 1.1em; width: 70%; }
        .squad-name-input:focus { border-bottom: 1px solid #cfaa70; outline: none; }
        .squad-list { flex-grow: 1; min-height: 100px; }
        .squad-member { display: flex; justify-content: space-between; padding: 5px; border-bottom: 1px dashed #444; font-size: 0.9em; }
        .remove-icon { color: #e74c3c; cursor: pointer; font-weight: bold; margin-left: 5px; }
        .remove-icon:hover { color: #ff6b6b; }
        .delete-tab-hint { font-size: 0.8em; color: #555; margin-left: 10px;}

    </style>
</head>
<body>

<div class="ro-panel">
    <h2>✦ RO 工會管理系統 ✦</h2>

    <div class="tab-container" id="tabContainer">
        <button class="tab-btn active" id="btn-memberTab" onclick="openTab('memberTab')">成員名單</button>
        <button class="tab-btn" id="btn-leaveTab" onclick="openTab('leaveTab')">假單管理 (連線中)</button>
        <button class="tab-btn tab-btn-add" onclick="createNewActivityTab()">+ 新增活動</button>
    </div>

    <div id="memberTab" class="tab-content active">
        <div class="filter-bar" id="jobFilterContainer">
            <button class="filter-btn active" onclick="filterByJob('All')">全部顯示</button>
        </div>

        <div class="input-group">
            <div class="input-item"><label>角色 ID</label><input type="text" id="mID" placeholder="ID"></div>
            <div class="input-item"><label>職業</label><select id="mJob"></select></div>
            <div class="input-item"><label>主戰力</label>
                <select id="mForce"><option value="否">否</option><option value="是">是</option></select>
            </div>
            <div class="input-item"><label>備註</label><input type="text" id="mNote" placeholder="備註"></div>
            <button class="ro-btn" onclick="addMember()">加入成員</button>
            <button class="ro-btn" style="background: #e67e22; border-color: #d35400;" onclick="saveAllData()">手動存檔</button>
        </div>

        <table id="guildTable">
            <thead>
                <tr>
                    <th onclick="sortTable('guildTable', 0)">ID</th>
                    <th onclick="sortTable('guildTable', 1)">職業</th>
                    <th onclick="sortTable('guildTable', 2)" class="center-col">主戰力</th>
                    <th onclick="sortTable('guildTable', 3)">備註</th>
                    <th class="center-col">管理</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <div id="leaveTab" class="tab-content">
        <div class="input-group">
            <div class="input-item"><label>填單時間</label><input type="text" id="lSubTime" readonly style="background:#444; color:#999;"></div>
            <div class="input-item"><label>遊戲名稱</label><input type="text" id="lName" placeholder="ID"></div>
            <div class="input-item"><label>請假時間</label><input type="text" id="lTime" placeholder="例: 10/25 晚上"></div>
            <div class="input-item"><label>事由</label><input type="text" id="lReason" placeholder="原因"></div>
            <button class="ro-btn" onclick="addLeave()">手動登錄</button>
        </div>
        <table id="leaveTable">
            <thead>
                <tr>
                    <th>傳送時間</th><th>遊戲名稱</th><th>請假時間</th><th>事由</th><th class="center-col">管理</th>
                </tr>
            </thead>
            <tbody><tr><td colspan="5" class="center-col">資料讀取中...</td></tr></tbody>
        </table>
    </div>
    
    <div id="dynamicContentContainer"></div>

</div>

<script>
    // --- 資料與全域變數 ---
    const JOB_DATA = {
        "騎士": "#e74c3c", "巫師": "#9b59b6", "獵人": "#2ecc71", "祭司": "#00d2d3",
        "武道家": "#e67e22", "刺客": "#ff9ff3", "鐵匠": "#95a5a6", "神槍手": "#d35400"
    };
    const DATA_SOURCE_URL = "https://script.google.com/macros/s/AKfycbyo_llFwKnrejzal9uO-csOAF2riIUg7Gx8kRRy4XMt8puqPWSp0QGFtIhyfTJGg3FtzQ/exec";

    // 核心資料結構
    let activityTabs = []; // 儲存動態活動的 ID 與 名稱 [{id: 'act_123', name: '城戰'}, ...]
    let activityData = {}; // 儲存每個活動的小隊編制 { 'act_123': { 'squad_1': [...] } }
    let squadCounter = 1;

    window.onload = function() {
        initJobUI();      
        fetchLeaveData(); 
        
        // 嘗試讀取存檔，如果沒有則建立預設
        loadAllData();

        setInterval(() => {
            let t = document.getElementById("lSubTime");
            if(t) t.value = new Date().toLocaleString('zh-TW', { hour12: false });
        }, 1000);
    };

    // --- 存檔與讀檔系統 (使用 LocalStorage) ---
    function saveAllData() {
        // 1. 抓取成員名單
        let members = [];
        let rows = document.getElementById("guildTable").querySelectorAll("tbody tr");
        rows.forEach(r => {
            members.push({
                id: r.cells[0].innerText,
                job: r.cells[1].innerText,
                force: r.querySelector(".force-yes") ? "是" : "否",
                note: r.cells[3].innerText
            });
        });

        // 2. 儲存所有設定
        let saveData = {
            members: members,
            activityTabs: activityTabs,
            activityData: activityData
        };
        localStorage.setItem("ro_guild_system_v1", JSON.stringify(saveData));
        console.log("資料已儲存");
    }

    function loadAllData() {
        let json = localStorage.getItem("ro_guild_system_v1");
        if (json) {
            let data = JSON.parse(json);
            activityTabs = data.activityTabs || [];
            activityData = data.activityData || {};
            
            // 還原成員名單
            let tbody = document.getElementById("guildTable").querySelector("tbody");
            tbody.innerHTML = "";
            if(data.members) {
                data.members.forEach(m => insertMemberRow(m.id, m.job, m.force, m.note));
            }
            
            // 還原活動分頁
            activityTabs.forEach(tab => createTabDOM(tab.id, tab.name));
            
            // 還原小隊畫面 (如果目前有活動分頁)
            activityTabs.forEach(tab => {
                let container = document.getElementById(tab.id);
                // 這裡我們需要根據 saved data 重建小隊框
                let squads = activityData[tab.id];
                if(squads) {
                    let squadContainer = container.querySelector(".squads-panel");
                    for(let sqId in squads) {
                        // 雖然資料有，但 DOM 還沒建，所以要先建 DOM
                        // 為了簡化，這裡我們只還原小隊結構，內容會在 render 時自動填入
                        // 需要先知道小隊名稱，這裡稍微簡化，假設使用者沒改隊名，或我們需要額外存隊名
                        // 暫時用 Generic 還原
                        createSquadDOM(squadContainer.id, sqId, "小隊"); 
                    }
                }
            });

        } else {
            // 預設資料
            insertMemberRow("SkyWalker", "騎士", "是", "主坦");
            insertMemberRow("HealerOne", "祭司", "是", "後援");
            // 預設建立一個城戰分頁
            createNewActivityTab("城戰配置");
        }
    }

    // --- 動態活動分頁邏輯 ---

    function createNewActivityTab(defaultName = null) {
        let name = defaultName;
        if (!name) {
            name = prompt("請輸入新活動名稱 (例如: GVG, 副本):");
            if (!name) return;
        }
        
        let tabId = "act_" + new Date().getTime(); // 唯一 ID
        
        // 更新資料結構
        activityTabs.push({ id: tabId, name: name });
        activityData[tabId] = {}; 

        createTabDOM(tabId, name);
        saveAllData(); // 自動存檔
    }

    function createTabDOM(tabId, name) {
        // 1. 新增按鈕
        let btnContainer = document.getElementById("tabContainer");
        let addBtn = document.querySelector(".tab-btn-add");
        
        let newBtn = document.createElement("button");
        newBtn.className = "tab-btn";
        newBtn.innerText = name;
        newBtn.id = "btn-" + tabId;
        newBtn.onclick = function() { openTab(tabId); };
        newBtn.ondblclick = function() { deleteTab(tabId, name); }; // 雙擊刪除
        newBtn.title = "雙擊可刪除此活動";
        
        btnContainer.insertBefore(newBtn, addBtn); // 插在"+"按鈕前面

        // 2. 新增內容區塊
        let contentContainer = document.getElementById("dynamicContentContainer");
        let contentDiv = document.createElement("div");
        contentDiv.id = tabId;
        contentDiv.className = "tab-content";
        
        let squadContainerId = tabId + "_squads";
        let standbyListId = tabId + "_standby";

        contentDiv.innerHTML = `
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                <button class="ro-btn btn-add-team" onclick="addNewSquad('${squadContainerId}')">+ 新增小隊</button>
                <span class="delete-tab-hint">提示：雙擊上方分頁按鈕可刪除此活動</span>
            </div>
            <div class="activity-container">
                <div class="standby-panel">
                    <div class="standby-title">待命成員 (點擊加入)</div>
                    <div id="${standbyListId}"></div>
                </div>
                <div class="squads-panel" id="${squadContainerId}"></div>
            </div>
        `;
        contentContainer.appendChild(contentDiv);
    }

    function deleteTab(tabId, name) {
        if(!confirm(`確定要刪除活動「${name}」嗎？所有編組將會消失。`)) return;
        
        // 移除 DOM
        document.getElementById("btn-" + tabId).remove();
        document.getElementById(tabId).remove();
        
        // 移除資料
        activityTabs = activityTabs.filter(t => t.id !== tabId);
        delete activityData[tabId];
        
        // 回到成員名單
        openTab('memberTab');
        saveAllData();
    }

    function openTab(tabId) {
        // UI 切換
        let contents = document.getElementsByClassName("tab-content");
        for (let c of contents) c.classList.remove("active");
        let btns = document.getElementsByClassName("tab-btn");
        for (let b of btns) b.classList.remove("active");
        
        document.getElementById(tabId).classList.add("active");
        
        // 處理按鈕 Active 狀態
        let btn = document.getElementById("btn-" + tabId);
        if(btn) btn.classList.add("active");

        // 如果是活動分頁，刷新該分頁的待命清單與小隊
        if (tabId.startsWith("act_")) {
            let squadContainerId = tabId + "_squads";
            let standbyListId = tabId + "_standby";
            
            // 渲染既有小隊 (如果是剛讀檔進來)
            let squads = activityData[tabId];
            let squadContainer = document.getElementById(squadContainerId);
            // 清空並重建小隊 DOM，確保資料同步
            squadContainer.innerHTML = ""; 
            for(let sqId in squads) {
                // 這裡無法得知隊名，暫時用 "小隊" 或是從資料結構優化。
                // 簡單起見，直接重建
                createSquadDOM(squadContainerId, sqId, "小隊");
                renderSquadMembers(tabId, sqId, standbyListId);
            }

            refreshStandbyList(standbyListId, tabId);
        }
    }

    // --- 小隊邏輯 ---

    function addNewSquad(containerId, defaultName = "新小隊") {
        let tabId = containerId.replace("_squads", "");
        let sqId = "sq_" + new Date().getTime() + "_" + Math.floor(Math.random()*1000);
        
        if(!activityData[tabId][sqId]) {
            activityData[tabId][sqId] = [];
        }

        createSquadDOM(containerId, sqId, defaultName);
        saveAllData();
        
        // 刷新待命清單 (因為多了一個小隊選項)
        refreshStandbyList(tabId + "_standby", tabId);
    }

    function createSquadDOM(containerId, sqId, name) {
        let container = document.getElementById(containerId);
        let tabId = containerId.replace("_squads", "");
        let standbyListId = tabId + "_standby";

        let div = document.createElement("div");
        div.className = "squad-box";
        div.id = sqId;
        div.innerHTML = `
            <div class="squad-header">
                <input type="text" class="squad-name-input" value="${name}" onchange="saveAllData()">
                <button class="ro-btn btn-delete" style="padding: 2px 5px; font-size:0.8em;" onclick="removeSquad('${tabId}', '${sqId}')">X</button>
            </div>
            <div class="squad-list"></div>
        `;
        container.appendChild(div);
    }

    function refreshStandbyList(listId, tabId) {
        let listDiv = document.getElementById(listId);
        listDiv.innerHTML = "";
        
        // 取得所有成員
        let members = [];
        let rows = document.getElementById("guildTable").querySelectorAll("tbody tr");
        rows.forEach(r => members.push({ id: r.cells[0].innerText, job: r.cells[1].innerText }));

        // 取得已入隊名單
        let assignedIDs = [];
        let squads = activityData[tabId];
        for(let sqId in squads) {
            squads[sqId].forEach(m => assignedIDs.push(m.id));
        }

        let squadContainerId = tabId + "_squads";
        let squadDivs = document.getElementById(squadContainerId).getElementsByClassName("squad-box");

        members.forEach(m => {
            let isAssigned = assignedIDs.includes(m.id);
            let jobColor = JOB_DATA[m.job] || "#fff";
            
            let card = document.createElement("div");
            card.className = "member-card" + (isAssigned ? " disabled" : "");
            
            // 產生選單
            let options = `<option value="">加入...</option>`;
            for(let sq of squadDivs) {
                let sqName = sq.querySelector(".squad-name-input").value;
                options += `<option value="${sq.id}">${sqName}</option>`;
            }

            card.innerHTML = `
                <div class="member-info">
                    <span class="job-text" style="color: ${jobColor}; font-size: 0.9em;">[${m.job}]</span>
                    <span>${m.id}</span>
                </div>
                ${isAssigned ? '<span style="color:#555; font-size:0.8em;">(已入隊)</span>' : 
                `<select onchange="addMemberToSquad(this, '${m.id}', '${m.job}', '${tabId}')" style="padding:2px; font-size:0.8em; width: 100px;">${options}</select>`}
            `;
            listDiv.appendChild(card);
        });
    }

    function addMemberToSquad(select, mId, mJob, tabId) {
        let sqId = select.value;
        if(!sqId) return;
        
        activityData[tabId][sqId].push({ id: mId, job: mJob });
        renderSquadMembers(tabId, sqId, tabId + "_standby");
        refreshStandbyList(tabId + "_standby", tabId);
        saveAllData();
    }

    function renderSquadMembers(tabId, sqId, listId) {
        let squadDiv = document.getElementById(sqId);
        if(!squadDiv) return; // 防呆
        let listDiv = squadDiv.querySelector(".squad-list");
        listDiv.innerHTML = "";

        let members = activityData[tabId][sqId];
        members.forEach((m, index) => {
            let jobColor = JOB_DATA[m.job] || "#fff";
            let row = document.createElement("div");
            row.className = "squad-member";
            row.innerHTML = `
                <span><span style="color:${jobColor}; font-weight:bold;">${m.job}</span> ${m.id}</span>
                <span class="remove-icon" onclick="removeMemberFromSquad('${tabId}', '${sqId}', ${index})">x</span>
            `;
            listDiv.appendChild(row);
        });
    }

    function removeMemberFromSquad(tabId, sqId, index) {
        activityData[tabId][sqId].splice(index, 1);
        renderSquadMembers(tabId, sqId, tabId + "_standby");
        refreshStandbyList(tabId + "_standby", tabId);
        saveAllData();
    }

    function removeSquad(tabId, sqId) {
        if(!confirm("刪除此小隊？")) return;
        delete activityData[tabId][sqId];
        document.getElementById(sqId).remove();
        refreshStandbyList(tabId + "_standby", tabId);
        saveAllData();
    }

    // --- 基礎功能 (新增成員/篩選) ---
    function initJobUI() {
        const select = document.getElementById("mJob");
        const filterContainer = document.getElementById("jobFilterContainer");
        select.innerHTML = ""; 
        for (let job in JOB_DATA) {
            let color = JOB_DATA[job];
            let option = document.createElement("option");
            option.value = job; option.text = job; option.style.color = color; option.style.fontWeight = "bold";
            select.appendChild(option);

            let btn = document.createElement("button");
            btn.className = "filter-btn"; btn.innerText = job; btn.style.borderColor = color;
            btn.onclick = function() { filterByJob(job); };
            filterContainer.appendChild(btn);
        }
    }

    function filterByJob(targetJob) {
        let btns = document.querySelectorAll(".filter-btn");
        btns.forEach(b => {
            if (b.innerText === targetJob || (targetJob === 'All' && b.innerText === '全部顯示')) {
                b.classList.add("active");
                if(targetJob !== 'All') { b.style.background = JOB_DATA[targetJob]; b.style.color = "#000"; }
            } else {
                b.classList.remove("active"); b.style.background = "#222"; b.style.color = "#888";
            }
        });
        let trs = document.getElementById("guildTable").querySelectorAll("tbody tr");
        trs.forEach(tr => {
            let rowJob = tr.getAttribute("data-job");
            tr.style.display = (targetJob === 'All' || rowJob === targetJob) ? "" : "none";
        });
    }

    function addMember() {
        let id = document.getElementById("mID").value;
        let job = document.getElementById("mJob").value;
        let force = document.getElementById("mForce").value;
        let note = document.getElementById("mNote").value;
        if(id === "") return alert("請輸入 ID");

        insertMemberRow(id, job, force, note);
        document.getElementById("mID").value = "";
        filterByJob('All');
        saveAllData(); // 新增後存檔
    }

    function insertMemberRow(id, job, force, note) {
        let tbody = document.getElementById("guildTable").querySelector("tbody");
        let row = tbody.insertRow();
        row.setAttribute("data-job", job);
        let jobColor = JOB_DATA[job] || "#fff";

        row.innerHTML = `
            <td contenteditable="true" class="editable" onblur="saveAllData()">${id}</td>
            <td class="job-text" style="color: ${jobColor};">${job}</td>
            <td class="center-col" onclick="toggleForce(this); saveAllData()"><span class="${force==='是'?'force-yes':'force-no'}">${force}</span></td>
            <td contenteditable="true" class="editable" onblur="saveAllData()">${note}</td>
            <td class="center-col"><button class="ro-btn btn-delete" onclick="deleteRow(this); saveAllData()">移除</button></td>
        `;
    }

    function deleteRow(btn) { btn.closest("tr").remove(); }
    function toggleForce(td) {
        let span = td.querySelector("span");
        if (span.innerText === "是") { span.innerText = "否"; span.className = "force-no"; } else { span.innerText = "是"; span.className = "force-yes"; }
    }
    
    // --- 假單與排序 (保持不變) ---
    function fetchLeaveData() {
        fetch(DATA_SOURCE_URL).then(r=>r.json()).then(data=>{
            let tbody = document.getElementById("leaveTable").querySelector("tbody");
            tbody.innerHTML = ""; 
            if (!data || data.length === 0) { tbody.innerHTML = "<tr><td colspan='5' class='center-col'>目前沒有假單</td></tr>"; return; }
            data.forEach(row => {
                let tr = tbody.insertRow();
                tr.innerHTML = `<td>${row[0]}</td><td contenteditable="true" class="editable">${row[1]}</td><td contenteditable="true" class="editable">${row[2]}</td><td contenteditable="true" class="editable">${row[3]}</td><td class="center-col"><button class="ro-btn btn-delete" onclick="deleteRow(this)">刪除</button></td>`;
            });
        });
    }
    function addLeave() { /* 保持原樣，略 */ }
    function sortTable(tableId, n) { /* 保持原樣，略 */ }
</script>

</body>
</html>